---
layout: jetpack-portfolio
title: Solving 2-D Diffusion using Strum-Liouville Equations
date: 2019-09-11 10:35:57.000000000 +05:30
type: jetpack-portfolio
parent_id: '0'
published: true
password: ''
status: publish
categories: []
tags: []
meta:
  _wpas_skip_22819558: '1'
  _publicize_job_id: '35708628580'
  _thumbnail_id: '337'
author:
  login: jaydm26
  email: jay@ilovecars.in
  display_name: jaydm26
  first_name: ''
  last_name: ''
permalink: "/portfolio/solving-2-d-diffusion-using-strum-liouville-equations/"
---
<p><!-- wp:paragraph {"align":"justify"} --></p>
<p class="has-text-align-justify">Sturm-Liouville Equations are a set of second-order linear differential equations that are given by:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex \displaystyle \dfrac {d}{dx} [p(x) \dfrac{dy}{dx}] + q(x)y = -\lambda w(x)y $</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>where $latex y$ is a function of $latex x$, and $latex p(x), q(x)$ and $latex w(x)$ are known, continuously differentiable functions of $latex x$ over the region $latex (a,b)$.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Sturm-Liouville equations are commonly observed in solving applied mathematical problems, especially in heat transfer and fluid dynamics problems. While they look extremely complicated, there is a hidden beauty in these equations which makes their solutions elegant.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>In the above equation, $latex \lambda $ represents the eigenvalues of the problem including the boundary conditions. The corresponding solutions are called the eigenfunctions.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Some important knowledge about eigenvalues and eigenfunctions with respect to the Sturm-Liouville problems is given below:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list {"ordered":true} --></p>
<ol>
<li>$latex \lambda_1 &lt; \lambda_2 &lt; \lambda_3 &lt; ... &lt; \lambda_n$ as $latex n\rightarrow \infty $; i.e. the eigenvalues are arranged in an ascending order.</li>
<li>Eigenvalues are unique, and each correspond to an eigenfunction. For each $latex \lambda_n$, $latex y_n(x)$ has exact $latex (n-1)$ zeros in $latex (a,b)$. $latex y_n(x)$ is referred to as the $latex nth$ zero of the Sturm-Liouville problem.</li>
<li>All eigenfunctions are normal to each other. Mathematically, <br />$latex \displaystyle \int_a^b y_m(x)y_n(x)w(x)dx = \delta_{mn}$</li>
</ol>
<p><!-- /wp:list --></p>
<p><!-- wp:paragraph --></p>
<p>The above text has been referenced from <a href="https://en.wikipedia.org/wiki/Sturm–Liouville_theory">Wikipedia</a>. I will subsequently try to build an intuition for a non-expert to spot these equations and solve them with confidence.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>One of the most common equations observed in applied mathematics is the Laplace equation. The Laplace equation is given by:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex  \displaystyle \Delta u = 0 $</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>In 1-D, this becomes:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex \dfrac{d^2 u}{dx^2} = 0$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>This has a direct solution by integrating twice. The solution is given by:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex u = C_1 x + C_2$,</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>where C<sub>1</sub> and C<sub>2</sub> are obtained from the boundary conditions given for the problem. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"justify"} --></p>
<p class="has-text-align-justify">If we look closely, we see that the differential equation is the diffusion equation in 1D. This is the same equation we would solve if we wanted to solve a 1D conduction problem without internal heat generation.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Expanding this to 2D,</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex \dfrac{{\partial}^2 u}{\partial x^2} + \dfrac{{\partial}^2 u}{\partial y^2}  = 0$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"justify"} --></p>
<p class="has-text-align-justify">This equation is solved using the concept of separation of variables, which is generally introduced in a calculus class. The concept involves stating that $latex \displaystyle u $ is a product of two functions- each function being only dependent on one independent variable. This idea of separating the solution into two functions works because of the inherent nature of the separation. The separation allows us to break down the problem into independent sub-problems that are equal to a constant. Solving these sub-problems while satisfying the boundary values will lead the full solution.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"justify"} --></p>
<p class="has-text-align-justify">In any case, let</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex u = X(x).Y(y)$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Substituting this in the above equation will show us something remarkable:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex Y(x)\dfrac{{\partial}^2 X(x)}{\partial x^2} + X(x)\dfrac{{\partial}^2 Y(y)}{\partial y^2} = 0$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Dividing by $latex u = X(x).Y(y)$, and rearranging,</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex \dfrac{1}{Y(x)} . \dfrac{{\partial}^2 Y(y)}{\partial y^2} = -\dfrac{1}{X(x)} . \dfrac{{\partial}^2 X(x)}{\partial x^2} $</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Since the left hand side and right hand side are function of different independent variables, and are equal, they must be equal to a constant. Let that constant by $latex \displaystyle \lambda^2$.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>In theory, the sign preceding $latex \displaystyle \lambda^2$ must be such that it produces a Sturm-Liouville Problem in the direction that has all homogeneous boundary condition. If readers are interested in knowing more about how this works out, I would refer them to some wonderful resources namely: <a rel="noreferrer noopener" aria-label="Heat Conduction, by Ozisik (opens in a new tab)" href="https://www.amazon.com/Heat-Conduction-David-W-Hahn-ebook/dp/B0091994XU" target="_blank">Heat Conduction, by Ozisik</a>, <a rel="noreferrer noopener" aria-label="explanation by Professor Sanjiva Lele (ICME, Stanford) (opens in a new tab)" href="https://www.youtube.com/watch?v=8aLlFqGLrhE" target="_blank">explanation by Professor Sanjiva Lele (ICME, Stanford)</a>, and <a rel="noreferrer noopener" aria-label="Wikipedia (opens in a new tab)" href="https://en.wikipedia.org/wiki/Sturm–Liouville_theory" target="_blank">Wikipedia</a>.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Assuming the following boundary conditions:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>$latex u(x = 0, y) = 0$<br />$latex u(x = L, y) = 0$<br />$latex u(x, y = 0) = 0$<br />$latex u(x, y = W) = 1$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>From above, we have:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex \dfrac{1}{Y(x)} . \dfrac{{\partial}^2 Y(y)}{\partial y^2} = -\dfrac{1}{X(x)} . \dfrac{{\partial}^2 X(x)}{\partial x^2} = \lambda^2 $.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">i.e. $latex \dfrac{{\partial}^2 Y(y)}{\partial y^2} - \lambda^2.Y(y) = 0$ and <br />       $latex \dfrac{{\partial}^2 X(x)}{\partial x^2} + \lambda^2.X(x) = 0$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The solutions to the above are:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex \displaystyle X(x) = C_1\cos(\lambda x) + C_2\sin(\lambda x)$<br />$latex Y(y) = C_3\cosh(\lambda y) + C_4\sinh(\lambda y)$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Thus,</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex u =  (C_1\cos(\lambda x) + C_2\sin(\lambda x))(C_3\cosh(\lambda y) + C_4\sinh(\lambda y))$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Applying the boundary conditions,</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex u(x = 0, y) = (C_1)(C_3\cosh(\lambda y) + C_4\sinh(\lambda y)) \Rightarrow C_1 = 0$<br />$latex u(x = L, y)  = (C_2\sin(\lambda L))(C_3\cosh(\lambda y) + C_4\sinh(\lambda y)) \Rightarrow sin(\lambda L) = 0 \Rightarrow \lambda = \dfrac{n\pi}{L}, n = 0, 1, 2, ...$<br />$latex u_n(x, y = 0) = (C_2\sin(\lambda_n x))(C_3) \Rightarrow C_3 = 0$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Thus,</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex u_n(x, y) = C_2\sin(\lambda_n x)C_4\sinh(\lambda_n y)$<br />$latex u_n(x, y) = C_n\sin(\lambda_n x)\sinh(\lambda_n y)$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>So the full solution to the problem is given by,</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex u(x,y) = \displaystyle\sum\limits_{n = 0}^{\infty} C_n\sin(\lambda_n x)\sinh(\lambda_n y)$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Using the last boundary condition now,</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex \displaystyle u(x, y = W)  = \displaystyle\sum\limits_{n = 0}^{\infty} C_n\sin(\lambda_n x)\sinh(\lambda_n W)$<br />i.e. $latex \displaystyle 1  = \sum\limits_{n = 0}^{\infty} a_n\sin(\lambda_n x)$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Using concepts of orthogonality, we can multiply both sides by $latex \displaystyle *\int_{x = 0}^{x = L} \sin(\lambda_m x)dx$.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Thus,</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex \displaystyle \int_{x = 0}^{x = L} \sin(\lambda_m x)dx = \displaystyle\int_{x = 0}^{x = L} \displaystyle\sum\limits_{n = 0}^{\infty} a_n\sin(\lambda_n x)\sin(\lambda_m x)dx$.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The right side, due to orthogonality will be non-zero only when $latex \displaystyle m = n$. Thus,</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex \displaystyle \int_{x = 0}^{x = L} \sin(\lambda_n x)dx = a_n\displaystyle\int_{x = 0}^{x = L} \sin^2(\lambda_n x)dx$<br />$latex \displaystyle \therefore a_n = \dfrac{\displaystyle\int_{x = 0}^{x = L} \sin(\lambda_n x) dx}{\displaystyle\int_{x = 0}^{x = L} \sin^2(\lambda_n x)dx}$.<br />$latex \displaystyle \Rightarrow C_n = \dfrac{\displaystyle\int_{x = 0}^{x = L} \sin(\lambda_n x) dx}{\sinh(\lambda_n W) \displaystyle\int_{x = 0}^{x = L} \sin^2(\lambda_n x)dx}$, where $latex \displaystyle \lambda_n = \dfrac{n\pi}{L}$.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The full solution thus is given by:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex \displaystyle u(x, y) = \sum\limits_{n = 0}^{\infty} \dfrac{\displaystyle\int_{x = 0}^{x = L} \sin(\lambda_n x) dx}{\sinh(\lambda_n W) \displaystyle\displaystyle\int_{x = 0}^{x = L} \sin^2(\lambda_n x)dx} \sin(\lambda_n x)\sinh(\lambda_n y)$ , where $latex \displaystyle \lambda_n = \dfrac{n\pi}{L} $</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":337,"sizeSlug":"large"} --></p>
<figure class="wp-block-image size-large"><img src="{{ site.baseurl }}/assets/2d_diffusion.jpg?w=1024" alt="" class="wp-image-337" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>After so much cumbersome math, the question one should ask is what on earth does all this mean physically. Yes, the math is pretty but if it has no physical meaning, it is of no use to us. So let us try to unwrap the physical meaning of our solution.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Let us first look at the solution at boundaries. As we would expect, the solution should agree with the boundary conditions we imposed on the problem. If they don't, our solution is wrong.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Starting with $latex x = 0$, $latex u(0,y) = 0$ as $latex \sin(\lambda_n * 0) = 0 $ always, thus satisfying the first boundary condition. Further, at $latex x = L$, $latex u(L,y) = 0$ as $latex \sin(\lambda_n * L) = \sin(\dfrac{n\pi}{L}L) = \sin(n\pi) = 0$ always, thus satisfying the second boundary condition.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Now, looking at $latex y = 0$, $latex u(x,0) = 0$ as $latex \sinh(\lambda_n * 0) = 0$ always, thus satisfying the third boundary condition. Now, at $latex y = W$, $latex u(x,W) = \displaystyle \sum_{n=0}^{\infty} \dfrac{\displaystyle\int_{x=0}^{x=L} \sin(\lambda_n x)dx}{\displaystyle\int_{x=0}^{x=L} \sin^2(\lambda_nx)dx} \sin(\lambda_nx)$. This needs to be further simplified. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Let us first look at $latex \displaystyle\int_{x=0}^{x=L}\sin(\lambda_nx)dx$. Replacing $latex \lambda_n = \dfrac{n\pi}{L}$, we have $latex \displaystyle \int_{x=0}^{x=L}\sin(\dfrac{n\pi x}{L})dx = \dfrac{L}{n\pi} [(-1)^{n+1} + 1]$.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Next, looking at $latex \displaystyle \int_{x=0}^{x=L}\sin^2(\lambda_nx)dx$. Replacing $latex \lambda_n = \dfrac{n\pi}{L}$, we have $latex \displaystyle \int_{x=0}^{x=L}\sin^2(\dfrac{n\pi x}{L})dx = \dfrac{L}{2}$.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Now, looking at the full term, we have:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex u(x,W) = \displaystyle \sum_{n=0}^{\infty} \dfrac{\dfrac{L}{n\pi} [(-1)^{n+1} + 1]}{\dfrac{L}{2}} \sin(\lambda_nx)$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex \therefore u(x,W) = \displaystyle \dfrac{2}{\pi}\sum_{n=0}^{\infty}\dfrac {[(-1)^{n+1} + 1]}{n} \sin(\dfrac{n\pi x}{L})$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>This is a Fourier series expansion for $latex f(x) = \text{sgn(x)}$. The Fourier series for $latex \text{sgn(x)} = \displaystyle \dfrac{2}{\pi}\sum_{n=0}^{\infty}\dfrac {[(-1)^{n+1} + 1]}{n} \sin(\dfrac{n\pi x}{L})$. In our domain, $latex x \in (0,L)$. Thus, the $latex \text{sgn(x)} = 1$. The proof for the Fourier expansion is left to the readers.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex \therefore u(x,W) = 1$.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Thus, we have successfully proved the boundary conditions for the problem are satisfied by our solution. Now, let us understand what this means physically inside the domain.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>If we were to fix the value of $latex y$, the solution will form a sum of sines for each location of $latex x$.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex u(x,y=constant) = \displaystyle\sum\limits_{n = 0}^{\infty} \dfrac{\sinh(\lambda_n y)\displaystyle\int_{x = 0}^{x = L} \sin(\lambda_n x) dx}{\sinh(\lambda_n W) \displaystyle\displaystyle\int_{x = 0}^{x = L} \sin^2(\lambda_n x)dx} \sin(\lambda_n x)$ , where $latex \displaystyle \lambda_n = \dfrac{n\pi}{L} $.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Rewriting this,</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex u(x,y=constant) = \displaystyle \sum\limits_{n=0}^{\infty} b_n \sin(\dfrac{n\pi x}{L})$.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>This is just the odd part of a Fourier series. Thus, for each value of $latex y$, the solution for $latex u$ can be described by the odd part of a Fourier series.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Similarly, if we fix the value of $latex x$, we will obtain:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex u(x=constant,y) = \displaystyle\sum\limits_{n = 0}^{\infty} \dfrac{\sin(\lambda_n x)\displaystyle\int_{x = 0}^{x = L} \sin(\lambda_n x) dx}{\sinh(\lambda_n W) \displaystyle\displaystyle\int_{x = 0}^{x = L} \sin^2(\lambda_n x)dx} \sinh(\lambda_n y)$ , where $latex \displaystyle \lambda_n = \dfrac{n\pi}{L} $.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Rewriting this, </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex u(x=constant,y) = \displaystyle \sum\limits_{n=0}^{\infty} a_n \sinh(\dfrac{n\pi x}{L})$.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>This is a sum of hyperbolic sines.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Doing this allows us to see that the solution has spatial frequencies. In a continuous sense, these frequencies do not carry much physical meaning. However in the discrete world, these frequencies govern how fast information is being transferred. This is critical in establishing the numerical stability of a method.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Further, also observe that $latex \displaystyle \dfrac{\partial u}{\partial x} \Biggr\vert_{x = \frac{L}{2}}= 0$. Thus, for all values of $latex y$, the peak of $latex u$ will occur at $latex x = \dfrac{L}{2}$ within the domain.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Thus, we now saw how we can solve the Laplace equation using the Sturm-Liouville formulation and what the solution means physically.</p>
<p><!-- /wp:paragraph --></p>
