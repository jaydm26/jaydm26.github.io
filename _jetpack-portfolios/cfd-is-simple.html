---
layout: jetpack-portfolio
title: CFD is SIMPLE
date: 
type: jetpack-portfolio
parent_id: '0'
published: false
password: ''
status: draft
categories: []
tags: []
meta: {}
author:
  login: jaydm26
  email: jay@ilovecars.in
  display_name: jaydm26
  first_name: ''
  last_name: ''
permalink: "/"
---
<p><!-- wp:paragraph --></p>
<p>Computational Fluid Dynamics (CFD) is fairly complicated. Boiled down to the basics, CFD is trying to solve the Navier-Stokes equations and satisfying continuity while making sure that initial and boundary conditions are satisfied.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>From a previous <a href="https://ingeniariusetmente.wordpress.com/portfolio/appreciating-the-fluid-equations/">post</a>, I have mentioned how complicated Navier-Stokes equations are. In 3D, there is no direct solution to the Navier-Stokes equation without any simplifications. This is why CFD is essential to solving flow problems quickly on a computer without spending money on experiments.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The process of CFD is as follows:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list {"ordered":true} --></p>
<ol>
<li>Discretization of the domain: This can be done in plenty of ways. Broadly, one can have a structured or an unstructured grid. The grid may or may not conform to the body present in the flow.</li>
<li>Apply Finite Methods: Use Finite Difference, Finite Element or Finite Volume Methods to discretize the Navier-Stokes equations and continuity equations. If time is involved, one needs to also include a single-step (Runge-Kutta, Euler) or multi-step (Adams-Bashforth, Adams-Moulten) time-differencing scheme.</li>
<li>Apply the Finite method to the discrete domain and form an AX = B problem. This step accounts for the boundary conditions.</li>
<li>Solve the AX=B problem using an iterative method. The iterative method accounts for satisfying the continuity.</li>
</ol>
<p><!-- /wp:list --></p>
<p><!-- wp:paragraph --></p>
<p>Each of the above topic can have its own separate post. As for this one, I will be talking about the most common iterative solver in CFD- the SIMPLE scheme.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>SIMPLE is an abbreviation for the Semi-Implicit Method for Pressure Linked Equations. This method is the most common method implemented by CFD solvers like Fluent, Star-CCM+, etc. So let us try to understand what this method is.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The discretized steady-state Naiver-Stokes equations applied to the staggered grid takes the following form:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>X-direction: $latex a_{i,J} u_{i,J} = \sum a_{nb} u_{nb} -  (p_{I,J} - p_{I-1,J}) A_{i,J} + b_{i,J}$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Y-direction: $latex a_{I,j} v_{I,j} = \sum a_{nb} v_{nb} - (p_{I,J} - p_{I,J-1}) A_{I,j} + b_{I,j}$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Continuity: $latex (\rho u A)_{I+1,J} - (\rho u A)_{I,J} + (\rho v A)_{I,J+1} - (\rho v A)_{I,J} = 0$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The above equations are true in 2D. Here $latex a$ refers to the coefficient formed for the velocity at each location (which is covered in the discretization), the subscript $latex nb$ means the neighboring cells, $latex b$ refers to the source term. All other variables carry their usual meanings.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The SIMPLE method in verbal form is as follows:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list {"ordered":true} --></p>
<ol>
<li>Take a guessed pressure to obtain guessed velocities using the discretized momentum equation.</li>
<li>Obtain a pressure correction field using the continuity equation.</li>
<li>Correct pressure using a relaxation factor ($latex \alpha_p$).</li>
<li>Correct velocities using corrected pressure.</li>
<li>Repeat steps 2-4 until convergence.</li>
</ol>
<p><!-- /wp:list --></p>
<p><!-- wp:paragraph --></p>
<p>In simple terms, this is nothing more than a prediction and a correction made to that prediction. In more mathematical terms, we have the following:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Let the guessed pressure field be given by $latex p^*$. We can use this guessed pressure to obtain the x and y velocities as follows:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>$latex a_{i,J}u^*_{i,J} = \sum a_{nb}u^*_{nb} + (p^*_{I-1,J}-p^*_{I,J})A_{i,J} + b_{i,J}$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>$latex a_{I,j} v^*_{I,j} = \sum a_{nb} v^*_{nb} + (p^*_{I,J-1} - p^*_{I,J}) A_{I,j} + b_{I,j}$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The above can be recast as an AX = B problem where X represents the x or y direction velocities stacked in column, A represents the operator operating on the x or y direction velocities, and B represents the known values (pressure field and source).</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>In a 2D problem, we expect A to be highly sparse, thus making inverting difficult. Thus, a fast solver is required. Thus, we employ the Gauss-Seidel (GS) Method or Successive Over-Relaxation (SOR) Method to solve the AX = B problem to desired amount of residual.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Once we obtain the velocity fields, our task is to see if these velocity fields would satisfy the continuity equation. If this fails, our velocity fields are no good. From inspection, we cannot be certain that any predicted pressure field will lead to the satisfaction of the continuity equation through the predicted velocities. Thus, we develop corrections for pressure and velocity:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex p = p^* + p' $<br />$latex u = u^* + u' $<br />$latex v = v^* + v' $</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>If we were to subtract the equation for guessed velocities from the discretized Navier-Stokes, we would have:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>$latex a_{i,J} (u_{i,J} - u^*_{i,J}) = \sum a_{nb}(u_{nb} - u^*_{nb}) + \biggr[(p_{I-1,J} - p^*_{I-1,J}) - (p_{I,J} - p^*_{I,J})\biggr] A_{i,J}$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>$latex a_{I,j} (v_{I,j} - v^*_{I,j}) = \sum a_{nb} (v_{nb} - v^*_{nb}) + \biggr[(p_{I,J-1} - p^*_{I,J-1}) - (p_{I,J} - p^*_{I,J})\biggr] A_{I,j}$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>If we observe, we see the correction terms (variable with a prime) in the above equations.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>$latex a_{i,J}u'_{i,J} = \sum a_{nb}u'_{nb} + (p'_{I-1,J}-p'_{I,J})A_{i,J}$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>$latex a_{I,j} v'_{I,j} = \sum a_{nb} v'_{nb} + (p'_{I,J-1} - p'_{I,J}) A_{I,j}$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Now comes the most important approximation and the reason why SIMPLE works so effectively for most general case problems. In the above equations, we can assume $latex \sum a_{nb} u'_{nb}$ and $latex \sum a_{nb} v'_{nb}$ to be very small as compared to the other terms. Thus, we are able to drop them and simplify the equations as:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>$latex a_{i,J}u'_{i,J} = (p^*_{I-1,J}-p^*_{I,J})A_{i,J}$ or $latex u'_{i,J} = (p^*_{I-1,J}-p^*_{I,J})d_{i,J}$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>$latex a_{I,j} v'_{I,j} = (p^*_{I,J-1} - p^*_{I,J}) A_{I,j}$ or $latex v'_{I,j} = (p^*_{I,J-1} - p^*_{I,J}) d_{I,j}$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>where $latex d_{i,J} = \dfrac{A_{i,J}}{a_{i,J}}$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Since we now have correction for velocities, it is time to correct the pressure as well. This is done using the continuity equation.</p>
<p><!-- /wp:paragraph --></p>
