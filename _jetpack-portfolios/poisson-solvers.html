---
layout: jetpack-portfolio
title: Poisson Solvers
date: 
type: jetpack-portfolio
parent_id: '0'
published: false
password: ''
status: draft
categories: []
tags: []
meta: {}
author:
  login: jaydm26
  email: jay@ilovecars.in
  display_name: jaydm26
  first_name: ''
  last_name: ''
permalink: "/"
---
<p><!-- wp:paragraph --></p>
<p>The Poisson Equation is one of the foundational equations in the physical world. It shows up in a variety of fields. One such field is fluid dynamics. Now, you may question where you see it in the Naiver-Stokes equation, but bear with me, and I will show you how the Poisson Equation forms a very important part of incompressible flows.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Take the Navier-Stokes equations and the continuity equation for an incompressible flow:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex \dfrac{\partial \textbf{u}}{\partial t} + \textbf{u}.\nabla\textbf{u} = -\dfrac{1}{\rho} \nabla p + \nu\nabla^2\textbf{u}$<br />and<br />$latex \nabla.\textbf{u} = 0$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>When solving the Navier-Stokes equation in discrete sense, we can solve them with complete disregard for continuity (or the divergence-free condition on velocity). The steps to solve the Naiver-Stokes discretely would go in this manner:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list {"ordered":true} --></p>
<ol>
<li>Guess the pressure field.</li>
<li>Obtain guessed velocity using guess pressure.</li>
<li>Find a way to correct the velocity to ensure we have divergence-free velocity field.</li>
</ol>
<p><!-- /wp:list --></p>
<p><!-- wp:paragraph --></p>
<p>If we look at the above equations and the steps I listed, we can see that we only have two variables to work with: Pressure ($latex p$) and Velocity ($latex \textbf{u}$). The momentum conservation equation can relate pressure and velocity, thus allowing us to move from guessed pressure to guessed velocity. We need another equation that would allow us to correct the velocity field (i.e. satisfy continuity) while not violating the momentum conservation. How do we get this equation? Let us take advantage of the continuity equation.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Take the divergence of the Navier-Stokes equation:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex \nabla.(\dfrac{\partial \textbf{u}}{\partial t} + \textbf{u}.\nabla\textbf{u}) = \nabla.(-\dfrac{1}{\rho} \nabla p + \nu\nabla^2\textbf{u})$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Look at each term individually:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list {"ordered":true} --></p>
<ol>
<li>$latex \nabla . (\dfrac{\partial \textbf{u}}{\partial t}) = \dfrac{\partial (\nabla.\textbf{u})}{\partial t} = 0$</li>
<li>$latex \nabla . (\nu\nabla^2\textbf{u}) = \nu\nabla^2(\nabla.\textbf{u}) = 0$</li>
<li>$latex \nabla . (-\dfrac{1}{\rho} \nabla p) = -\dfrac{1}{\rho} \nabla^2 p$</li>
<li>$latex \nabla . (\textbf{u}.\nabla\textbf{u}) = \nabla\textbf{u} . \nabla\textbf{u} = \dfrac{\partial u_i}{\partial x_j}\dfrac{\partial u_j}{\partial x_i}$</li>
</ol>
<p><!-- /wp:list --></p>
<p><!-- wp:paragraph --></p>
<p>Thus, the divergence of Navier-Stokes is:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph {"align":"center"} --></p>
<p class="has-text-align-center">$latex \dfrac{1}{\rho} \nabla^2 p = -\dfrac{\partial u_i}{\partial x_j}\dfrac{\partial u_j}{\partial x_i}$</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>This is the Pressure Poisson Equation. The above equations says that the we can obtain a pressure field from a given velocity field that will satisfy both momentum and mass (continuity) conservation. Thus, we can use this equation to correct our pressure field. This corrected pressure can then be used to correct velocities.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>One should ask the question here: why not just start with this equation and use guessed velocities to solve pressure and then correct them. The reason to do this is because if we guessed velocities, we have not yet satisfied the momentum conservation. We now have no means to correct the velocity field which can correct the pressure field.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>In more concrete terms, the Navier-Stokes forms the equation we have to solve. The Pressure Poisson Equation forms the forcing function which gives us information on $latex \textbf{u}$ through $latex p$.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>This approach is the key foundation to writing your own CFD code.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>In CFD solvers, each step has a certain amount of complexity to solve. If we go step-by-step and note the complexity in the Big-O notation($latex \mathcal{O}$), we have the following:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list {"ordered":true} --></p>
<ol>
<li>Assuming we have $latex N_x$ points in the X-direction and $latex N_y$ points in the Y-direction. Thus, we have $latex \mathcal{O}(N_xN_y) complexity to obtain the Laplace of the velocity field. Gradients of the pressure field are calculated with an $latex \mathcal{O}(N_xN_y) per direction.</li>
<li></li>
</ol>
<p><!-- /wp:list --></p>
